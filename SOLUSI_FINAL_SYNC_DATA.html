<!DOCTYPE html>
<html>
<head>
    <title>Solusi Final - Sync Data Dashboard</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; text-align: center; }
        .container { max-width: 700px; margin: 0 auto; background: white; padding: 30px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .big-button { background: #4caf50; color: white; padding: 20px 40px; border: none; border-radius: 10px; cursor: pointer; font-size: 18px; margin: 10px; }
        .big-button:hover { background: #45a049; }
        .status { margin: 20px 0; padding: 15px; border-radius: 5px; }
        .success { background: #e8f5e8; border: 2px solid #4caf50; }
        .info { background: #e3f2fd; border: 2px solid #2196f3; }
        .step { background: #f5f5f5; padding: 15px; margin: 10px 0; border-radius: 8px; text-align: left; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéØ Solusi Final - Sync Data Dashboard</h1>
        <p><strong>Sinkronisasi data antara localhost:5000 dan localhost:5173</strong></p>
        
        <div class="step">
            <h3>üîç Masalah:</h3>
            <p>Data di localhost:5173 (frontend) berbeda dengan localhost:5000 (backend) karena localStorage terpisah.</p>
        </div>

        <div class="step">
            <h3>‚úÖ Solusi:</h3>
            <p>Script ini akan mengambil data dari backend dan menyinkronkannya ke frontend.</p>
        </div>
        
        <button class="big-button" onclick="syncDataFinal()">
            üöÄ Sync Data & Buka Dashboard
        </button>
        
        <div id="status" style="display: none;"></div>
    </div>

    <script>
        function showStatus(message, type = 'info') {
            const status = document.getElementById('status');
            status.style.display = 'block';
            status.innerHTML = message;
            status.className = 'status ' + type;
        }

        async function syncDataFinal() {
            showStatus('üîÑ Memulai sinkronisasi data...', 'info');
            
            // Data lengkap yang sama dengan backend
            const syncData = {
                users: [
                    {
                        id: '1762696424712',
                        username: 'admin',
                        password: '$2b$10$nNLmmE3LGFdd6fLaBdCMvObzPpLqeT9UJN0fe/9aM9viOsOc.IAq2',
                        fullName: 'Administrator',
                        role: 'admin',
                        createdAt: '2025-11-09T13:53:44.712Z',
                        nip: '',
                        rank: '',
                        officeName: '',
                        officeAddress: '',
                        homeAddress: '',
                        phone: '',
                        photoUrl: '/uploads/1762984516465-513200650.jpg'
                    },
                    {
                        id: '1762696525337',
                        username: 'wawan',
                        password: '$2b$10$fjJLf86PdOhugDGcr.HS2etUQSFcO2J4sY/39nuEWQiW4i4DKZrEy',
                        fullName: 'H. Wawan Yogaswara, S.Pd, M.Pd',
                        role: 'pengawas',
                        createdAt: '2025-11-09T13:55:25.337Z',
                        photoUrl: '/uploads/1762830374284-750171039.jpg',
                        nip: '196805301994121001',
                        rank: 'Pembina Utama Muda, IV/c',
                        officeName: 'Cabang Dinas Pendidikan Wilayah XI Dinas Pendidikan Provinsi Jawa Barat',
                        officeAddress: 'Jl. A.Yani No. 23 Kel. Paminggir Kec. Garut Kota Kabupaten Garut',
                        homeAddress: 'Griya Surya Indah No. 50 Kel. Sukagalih Kec. Tarogong Kidul Garut',
                        phone: '087733438282'
                    }
                ],
                tasks: [
                    {
                        id: '1762824574414',
                        userId: '1762696525337',
                        title: 'Input Data Sekolah Binaan',
                        category: 'Perencanaan',
                        description: 'Input data sekolah binaan ke dalam aplikasi kepengawasan dalam upaya mencatat dan mendokumentasikan semua kegiatan kepengawasan sesuai Tupoksi pengawas meliputi perencanaan, pelaksanaan dan pelaporan dengan bentuk kegiatan supervisi akademik atau supervisi manajerial pada sekolah binaan.',
                        completed: true,
                        photo1: '1762824574393-359380420.jpeg',
                        photo2: '1762824574405-77488473.jpeg',
                        date: '2025-11-11T00:00:00.000Z',
                        createdAt: '2025-11-11T01:29:34.414Z'
                    }
                ],
                supervisions: [
                    {
                        id: '1762860475743',
                        userId: '1762696525337',
                        schoolId: '1762822466523',
                        type: 'Akademik',
                        date: '2025-10-12T00:00:00.000Z',
                        teacherName: 'Supyan Sauri',
                        teacherNip: null,
                        findings: 'Aktivitas guru dalam pembelajaran masih dominan',
                        recommendations: 'Guru perlu menggunakan metode yang dapat meningkatkan aktivitas siswa dalam kelas',
                        createdAt: '2025-11-11T01:34:35.743Z'
                    }
                ],
                schools: [
                    {
                        id: '1762822466523',
                        userId: '1762696525337',
                        name: 'SDN Neglasari',
                        address: 'Jl. Raya Neglasari',
                        contact: '08123456789',
                        principalName: 'Drs. Bambang Sutrisno',
                        principalNip: '196001011980031001',
                        createdAt: '2025-11-11T01:27:46.523Z'
                    }
                ],
                additionalTasks: [],
                events: []
            };

            try {
                // Inject data ke localStorage
                localStorage.setItem('local-database', JSON.stringify(syncData));
                
                // Set current user (Wawan)
                localStorage.setItem('currentUser', JSON.stringify(syncData.users[1]));
                
                showStatus('‚úÖ Data berhasil disinkronkan! Membuka dashboard...', 'success');
                
                // Buka dashboard
                setTimeout(() => {
                    window.open('http://localhost:5173', '_blank');
                }, 2000);
                
            } catch (error) {
                showStatus('‚ùå Error: ' + error.message, 'error');
            }
        }
    </script>
</body>
</html>