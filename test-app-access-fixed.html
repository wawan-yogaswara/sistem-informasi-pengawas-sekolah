<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‚úÖ Test App Access - FIXED</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 900px;
            margin: 30px auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        .container {
            background: rgba(255, 255, 255, 0.95);
            color: #333;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        }
        .success {
            color: #16a34a;
            background: #dcfce7;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 4px solid #16a34a;
        }
        .error {
            color: #dc2626;
            background: #fef2f2;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 4px solid #dc2626;
        }
        .info {
            color: #2563eb;
            background: #dbeafe;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 4px solid #2563eb;
        }
        .warning {
            color: #d97706;
            background: #fef3c7;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 4px solid #d97706;
        }
        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            margin: 8px;
            transition: transform 0.2s;
        }
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }
        .btn-success {
            background: linear-gradient(135deg, #16a34a 0%, #15803d 100%);
        }
        .btn-danger {
            background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);
        }
        .port-info {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        .port-card {
            background: #f8fafc;
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #e2e8f0;
            text-align: center;
        }
        .port-card h3 {
            margin-top: 0;
            color: #1e293b;
        }
        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 8px;
        }
        .status-online { background: #16a34a; }
        .status-offline { background: #dc2626; }
        .status-unknown { background: #6b7280; }
    </style>
</head>
<body>
    <div class="container">
        <h1>‚úÖ APLIKASI SUDAH DIPERBAIKI!</h1>
        
        <div class="success">
            <h3>üéâ Masalah Teridentifikasi dan Diperbaiki!</h3>
            <p>Server backend dan frontend sekarang berjalan di port yang berbeda seperti seharusnya.</p>
        </div>

        <div class="port-info">
            <div class="port-card">
                <h3>üñ•Ô∏è Backend Server</h3>
                <p><strong>Port: 5000</strong></p>
                <p>API & Server Logic</p>
                <div id="backendStatus">
                    <span class="status-indicator status-unknown"></span>
                    Checking...
                </div>
                <button onclick="testBackend()">Test Backend</button>
            </div>
            
            <div class="port-card">
                <h3>üåê Frontend App</h3>
                <p><strong>Port: 5173</strong></p>
                <p>React Application</p>
                <div id="frontendStatus">
                    <span class="status-indicator status-unknown"></span>
                    Checking...
                </div>
                <button onclick="testFrontend()">Test Frontend</button>
            </div>
        </div>

        <div class="info">
            <h3>üîß Yang Sudah Diperbaiki:</h3>
            <ul>
                <li>‚úÖ Syntax error di App.tsx</li>
                <li>‚úÖ Duplicate functions di additional-tasks.tsx</li>
                <li>‚úÖ Server backend berjalan di port 5000</li>
                <li>‚úÖ Frontend Vite dev server di port 5173</li>
                <li>‚úÖ Pemisahan backend dan frontend</li>
            </ul>
        </div>

        <div style="text-align: center; margin: 30px 0;">
            <button onclick="setupAuth()" class="btn-success">üîë Setup Auth & Open App</button>
            <button onclick="openFrontend()" class="btn-success">üöÄ Buka Aplikasi (Port 5173)</button>
            <button onclick="openBackend()">üîß Buka Backend (Port 5000)</button>
        </div>

        <div id="results"></div>

        <div class="warning">
            <h3>üìù Catatan Penting:</h3>
            <ul>
                <li><strong>Frontend:</strong> http://localhost:5173 (React App)</li>
                <li><strong>Backend:</strong> http://localhost:5000 (API Server)</li>
                <li>Gunakan port 5173 untuk mengakses aplikasi</li>
                <li>Port 5000 hanya untuk API calls</li>
            </ul>
        </div>
    </div>

    <script>
        function showResult(message, type = 'info') {
            const results = document.getElementById('results');
            const className = type === 'success' ? 'success' : type === 'error' ? 'error' : type === 'warning' ? 'warning' : 'info';
            results.innerHTML += `<div class="${className}">${message}</div>`;
        }

        function updateStatus(elementId, status, online) {
            const element = document.getElementById(elementId);
            const indicator = online ? 'status-online' : 'status-offline';
            element.innerHTML = `<span class="status-indicator ${indicator}"></span>${status}`;
        }

        async function testBackend() {
            showResult('üîÑ Testing backend server (port 5000)...', 'info');
            
            try {
                const response = await fetch('http://localhost:5000/api/schools');
                if (response.ok) {
                    const data = await response.json();
                    updateStatus('backendStatus', 'Online ‚úÖ', true);
                    showResult(`‚úÖ Backend OK! Found ${data.length || 0} schools`, 'success');
                } else {
                    updateStatus('backendStatus', 'Error ‚ö†Ô∏è', false);
                    showResult(`‚ö†Ô∏è Backend responding but error: ${response.status}`, 'warning');
                }
            } catch (error) {
                updateStatus('backendStatus', 'Offline ‚ùå', false);
                showResult(`‚ùå Backend not accessible: ${error.message}`, 'error');
            }
        }

        async function testFrontend() {
            showResult('üîÑ Testing frontend server (port 5173)...', 'info');
            
            try {
                const response = await fetch('http://localhost:5173/');
                if (response.ok) {
                    updateStatus('frontendStatus', 'Online ‚úÖ', true);
                    showResult('‚úÖ Frontend server accessible!', 'success');
                } else {
                    updateStatus('frontendStatus', 'Error ‚ö†Ô∏è', false);
                    showResult(`‚ö†Ô∏è Frontend error: ${response.status}`, 'warning');
                }
            } catch (error) {
                updateStatus('frontendStatus', 'Offline ‚ùå', false);
                showResult(`‚ùå Frontend not accessible: ${error.message}`, 'error');
            }
        }

        function setupAuth() {
            showResult('üîë Setting up authentication...', 'info');
            
            // Clear any existing auth
            localStorage.clear();
            
            // Set proper auth data
            localStorage.setItem('auth_token', 'admin-token-' + Date.now());
            localStorage.setItem('user_data', JSON.stringify({
                id: 'admin-user',
                username: 'admin',
                fullName: 'Administrator',
                role: 'admin',
                nip: '123456789',
                email: 'admin@schoolguard.local'
            }));
            
            showResult('‚úÖ Authentication setup complete!', 'success');
            showResult('üöÄ Opening application...', 'info');
            
            setTimeout(() => {
                window.open('http://localhost:5173', '_blank');
            }, 1000);
        }

        function openFrontend() {
            showResult('üåê Opening frontend application...', 'info');
            window.open('http://localhost:5173', '_blank');
        }

        function openBackend() {
            showResult('üîß Opening backend server...', 'info');
            window.open('http://localhost:5000', '_blank');
        }

        // Auto-test on load
        window.onload = function() {
            setTimeout(() => {
                testBackend();
                testFrontend();
            }, 1000);
        };
    </script>
</body>
</html>