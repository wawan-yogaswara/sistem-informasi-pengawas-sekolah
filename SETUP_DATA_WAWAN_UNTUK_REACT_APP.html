<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Setup Data Wawan untuk React App</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #f8f9fa; }
        .container { max-width: 1000px; margin: 0 auto; }
        .card { background: white; margin: 20px 0; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .success { background: #d4edda; border-left: 4px solid #28a745; color: #155724; }
        .error { background: #f8d7da; border-left: 4px solid #dc3545; color: #721c24; }
        .warning { background: #fff3cd; border-left: 4px solid #ffc107; color: #856404; }
        .info { background: #d1ecf1; border-left: 4px solid #17a2b8; color: #0c5460; }
        button { 
            background: #007bff; color: white; border: none; padding: 12px 20px; 
            border-radius: 4px; cursor: pointer; margin: 5px; font-size: 14px;
            transition: background 0.3s;
        }
        button:hover { background: #0056b3; }
        button.success { background: #28a745; }
        button.success:hover { background: #1e7e34; }
        button.danger { background: #dc3545; }
        button.danger:hover { background: #c82333; }
        .step { margin: 15px 0; padding: 15px; background: #f8f9fa; border-radius: 4px; border-left: 4px solid #007bff; }
        .step-number { 
            background: #007bff; color: white; width: 30px; height: 30px; 
            border-radius: 50%; display: inline-flex; align-items: center; 
            justify-content: center; margin-right: 10px; font-weight: bold;
        }
        pre { background: #f8f9fa; padding: 15px; border-radius: 4px; overflow-x: auto; font-size: 12px; }
        .photo-preview { width: 60px; height: 60px; border-radius: 50%; object-fit: cover; margin: 5px; }
        h1 { text-align: center; color: #333; margin-bottom: 30px; }
        h2 { color: #007bff; border-bottom: 2px solid #007bff; padding-bottom: 10px; }
        .status-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; }
        .status-item { padding: 15px; border-radius: 4px; text-align: center; }
        .status-ok { background: #d4edda; color: #155724; }
        .status-error { background: #f8d7da; color: #721c24; }
        .status-pending { background: #fff3cd; color: #856404; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîß Setup Data Wawan untuk React App</h1>
        
        <div class="card warning">
            <h2>‚ö†Ô∏è INSTRUKSI PENTING</h2>
            <p><strong>Jalankan file ini SEBELUM membuka aplikasi React!</strong></p>
            <p>File ini akan memastikan data Wawan tersedia dengan format yang benar untuk aplikasi React.</p>
        </div>

        <div class="card">
            <h2>üöÄ Setup Otomatis</h2>
            <button onclick="setupAllData()" class="success" style="font-size: 16px; padding: 15px 30px;">
                üîß SETUP SEMUA DATA WAWAN
            </button>
            <div id="setupStatus"></div>
        </div>

        <div class="card">
            <h2>üìä Status Data</h2>
            <div class="status-grid" id="statusGrid">
                <div class="status-item status-pending">‚è≥ Menunggu setup...</div>
            </div>
        </div>

        <div class="card">
            <h2>üîç Verifikasi Manual</h2>
            <div class="step">
                <span class="step-number">1</span>
                <strong>Cek Profil Wawan</strong>
                <button onclick="checkProfile()">Cek Profil</button>
                <div id="profileCheck"></div>
            </div>

            <div class="step">
                <span class="step-number">2</span>
                <strong>Cek Aktivitas Wawan</strong>
                <button onclick="checkActivities()">Cek Aktivitas</button>
                <div id="activitiesCheck"></div>
            </div>

            <div class="step">
                <span class="step-number">3</span>
                <strong>Cek User Management</strong>
                <button onclick="checkUserManagement()">Cek User Management</button>
                <div id="userMgmtCheck"></div>
            </div>
        </div>

        <div class="card">
            <h2>üõ†Ô∏è Tools</h2>
            <button onclick="showDebugInfo()">Debug Info</button>
            <button onclick="exportData()">Export Data</button>
            <button onclick="clearData()" class="danger">Clear Data</button>
            <div id="debugOutput"></div>
        </div>
    </div>

    <script>
        // Main setup function
        async function setupAllData() {
            const statusDiv = document.getElementById('setupStatus');
            statusDiv.innerHTML = '<div class="info">üîÑ Memulai setup data Wawan...</div>';
            
            try {
                // 1. Setup User Profile
                setupUserProfile();
                await sleep(500);
                
                // 2. Setup Activities
                setupActivities();
                await sleep(500);
                
                // 3. Setup User Management
                setupUserManagement();
                await sleep(500);
                
                // 4. Update status
                updateStatusGrid();
                
                statusDiv.innerHTML = `
                    <div class="success">
                        ‚úÖ <strong>SETUP SELESAI!</strong>
                        <br>Semua data Wawan telah disetup dengan benar.
                        <br>Sekarang buka aplikasi React untuk melihat hasilnya.
                    </div>
                `;
                
                // Auto-verify
                setTimeout(() => {
                    checkProfile();
                    checkActivities();
                    checkUserManagement();
                }, 1000);
                
            } catch (error) {
                statusDiv.innerHTML = `
                    <div class="error">
                        ‚ùå <strong>SETUP GAGAL!</strong>
                        <br>Error: ${error.message}
                    </div>
                `;
            }
        }

        // Setup functions
        function setupUserProfile() {
            console.log('üîÑ Setting up user profile...');
            
            const wawanProfile = {
                id: 'wawan-123',
                username: 'wawan',
                fullName: 'H. Wawan Yogaswara, S.Pd, M.Pd',
                nip: '196805301994121001',
                rank: 'Pembina Utama Muda, IV/c',
                phone: '087733438282',
                email: 'wawan.yogaswara@disdik.jabar.go.id',
                department: 'Cabang Dinas Pendidikan Wilayah XI',
                role: 'pengawas',
                photoUrl: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgZmlsbD0iIzMzNzNkYyIvPjx0ZXh0IHg9IjUwIiB5PSI1NSIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjE0IiBmaWxsPSJ3aGl0ZSIgdGV4dC1hbmNob3I9Im1pZGRsZSI+V2F3YW48L3RleHQ+PC9zdmc+',
                status: 'active',
                lastLogin: new Date().toISOString(),
                createdAt: '2024-01-01T00:00:00.000Z',
                updatedAt: new Date().toISOString()
            };

            // Save to all possible profile keys
            const profileKeys = [
                'user_data',
                'current_user', 
                'user_profile',
                'profile_data',
                'profile_info',
                'userProfile'
            ];

            profileKeys.forEach(key => {
                localStorage.setItem(key, JSON.stringify(wawanProfile));
            });

            console.log('‚úÖ User profile setup complete');
        }

        function setupActivities() {
            console.log('üîÑ Setting up activities...');
            
            const activities = {
                tasks: [
                    {
                        id: 'task-wawan-1',
                        title: 'Supervisi dan pembinaan Kepala SMKN 14 Garut',
                        name: 'Supervisi dan pembinaan Kepala SMKN 14 Garut',
                        description: 'Melakukan supervisi akademik dan pembinaan kepala sekolah SMKN 14 Garut',
                        category: 'Supervisi Akademik',
                        completed: true,
                        date: '2025-01-15T00:00:00.000Z',
                        userId: 'wawan-123',
                        username: 'wawan',
                        createdBy: 'wawan',
                        assignedTo: 'wawan'
                    },
                    {
                        id: 'task-wawan-2',
                        title: 'Evaluasi program sekolah penggerak SMKN 4 Garut',
                        name: 'Evaluasi program sekolah penggerak SMKN 4 Garut',
                        description: 'Evaluasi implementasi program sekolah penggerak di SMKN 4 Garut',
                        category: 'Evaluasi Program',
                        completed: false,
                        date: '2025-01-18T00:00:00.000Z',
                        userId: 'wawan-123',
                        username: 'wawan',
                        createdBy: 'wawan',
                        assignedTo: 'wawan'
                    }
                ],
                supervisions: [
                    {
                        id: 'sup-wawan-1',
                        schoolName: 'SMKN 14 Garut',
                        school: 'SMKN 14 Garut',
                        type: 'Supervisi Akademik',
                        findings: 'Pembelajaran sudah sesuai kurikulum merdeka, namun perlu peningkatan dalam penggunaan teknologi pembelajaran',
                        recommendations: 'Tingkatkan penggunaan media pembelajaran digital dan platform e-learning',
                        notes: 'Supervisi berjalan lancar, kepala sekolah sangat kooperatif dalam implementasi perbaikan',
                        date: '2025-01-15T00:00:00.000Z',
                        userId: 'wawan-123',
                        username: 'wawan',
                        createdBy: 'wawan'
                    },
                    {
                        id: 'sup-wawan-2',
                        schoolName: 'SMKN 4 Garut',
                        school: 'SMKN 4 Garut',
                        type: 'Supervisi Manajerial',
                        findings: 'Manajemen sekolah sudah baik, namun sistem dokumentasi masih perlu diperbaiki',
                        recommendations: 'Perbaiki sistem dokumentasi dan arsip sekolah, implementasikan sistem digital',
                        notes: 'Perlu follow up dalam 2 minggu untuk memastikan perbaikan dokumentasi',
                        date: '2025-01-18T00:00:00.000Z',
                        userId: 'wawan-123',
                        username: 'wawan',
                        createdBy: 'wawan'
                    }
                ],
                events: [
                    {
                        id: 'event-wawan-1',
                        title: 'Rapat Koordinasi Pengawas Sekolah',
                        name: 'Rapat Koordinasi Pengawas Sekolah',
                        description: 'Rapat koordinasi bulanan pengawas sekolah se-Kabupaten Garut membahas program kerja dan evaluasi',
                        date: '2025-01-15T00:00:00.000Z',
                        time: '09:00',
                        location: 'Aula Dinas Pendidikan Garut',
                        userId: 'wawan-123',
                        username: 'wawan',
                        createdBy: 'wawan'
                    },
                    {
                        id: 'event-wawan-2',
                        title: 'Workshop Implementasi Kurikulum Merdeka',
                        name: 'Workshop Implementasi Kurikulum Merdeka',
                        description: 'Workshop peningkatan kapasitas pengawas dalam implementasi dan monitoring kurikulum merdeka',
                        date: '2025-01-25T00:00:00.000Z',
                        time: '08:00',
                        location: 'Hotel Santika Garut',
                        userId: 'wawan-123',
                        username: 'wawan',
                        createdBy: 'wawan'
                    }
                ],
                additionalTasks: [
                    {
                        id: 'add-wawan-1',
                        name: 'Rapat Koordinasi Pengawas Sekolah',
                        title: 'Rapat Koordinasi Pengawas Sekolah',
                        description: 'Mengikuti rapat koordinasi pengawas sekolah tingkat kabupaten untuk membahas program kerja semester genap',
                        organizer: 'Dinas Pendidikan Kabupaten Garut',
                        location: 'Aula Dinas Pendidikan Garut',
                        date: '2025-01-15T00:00:00.000Z',
                        userId: 'wawan-123',
                        username: 'wawan',
                        createdBy: 'wawan'
                    },
                    {
                        id: 'add-wawan-2',
                        name: 'Workshop Kurikulum Merdeka',
                        title: 'Workshop Kurikulum Merdeka',
                        description: 'Mengikuti workshop implementasi kurikulum merdeka untuk pengawas sekolah tingkat provinsi',
                        organizer: 'Dinas Pendidikan Provinsi Jawa Barat',
                        location: 'Hotel Santika Garut',
                        date: '2025-01-30T00:00:00.000Z',
                        userId: 'wawan-123',
                        username: 'wawan',
                        createdBy: 'wawan'
                    }
                ]
            };

            // Save to main database
            localStorage.setItem('local-database', JSON.stringify(activities));

            // Save to individual keys as fallback
            localStorage.setItem('tasks', JSON.stringify(activities.tasks));
            localStorage.setItem('supervisions', JSON.stringify(activities.supervisions));
            localStorage.setItem('events', JSON.stringify(activities.events));
            localStorage.setItem('calendar_events', JSON.stringify(activities.events));
            localStorage.setItem('additional_tasks', JSON.stringify(activities.additionalTasks));
            localStorage.setItem('additionalTasks', JSON.stringify(activities.additionalTasks));

            console.log('‚úÖ Activities setup complete');
        }

        function setupUserManagement() {
            console.log('üîÑ Setting up user management...');
            
            const users = [
                {
                    id: 'wawan-123',
                    username: 'wawan',
                    fullName: 'H. Wawan Yogaswara, S.Pd, M.Pd',
                    nip: '196805301994121001',
                    rank: 'Pembina Utama Muda, IV/c',
                    phone: '087733438282',
                    email: 'wawan.yogaswara@disdik.jabar.go.id',
                    department: 'Cabang Dinas Pendidikan Wilayah XI',
                    role: 'pengawas',
                    photoUrl: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgZmlsbD0iIzMzNzNkYyIvPjx0ZXh0IHg9IjUwIiB5PSI1NSIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjE0IiBmaWxsPSJ3aGl0ZSIgdGV4dC1hbmNob3I9Im1pZGRsZSI+V2F3YW48L3RleHQ+PC9zdmc+',
                    status: 'active',
                    lastLogin: new Date().toISOString(),
                    createdAt: '2024-01-01T00:00:00.000Z',
                    updatedAt: new Date().toISOString()
                },
                {
                    id: 'admin-1',
                    username: 'admin',
                    fullName: 'Administrator Sistem',
                    role: 'admin',
                    email: 'admin@disdik.jabar.go.id',
                    department: 'Cabang Dinas Pendidikan Wilayah XI',
                    photoUrl: null,
                    status: 'active',
                    createdAt: '2024-01-01T00:00:00.000Z',
                    updatedAt: new Date().toISOString()
                }
            ];

            // Save users data
            localStorage.setItem('users', JSON.stringify(users));
            localStorage.setItem('app_users', JSON.stringify(users));
            localStorage.setItem('user_list', JSON.stringify(users));

            console.log('‚úÖ User management setup complete');
        }

        // Check functions
        function checkProfile() {
            const profile = localStorage.getItem('user_profile');
            const checkDiv = document.getElementById('profileCheck');
            
            if (profile) {
                const data = JSON.parse(profile);
                checkDiv.innerHTML = `
                    <div class="success">
                        ‚úÖ Profil Wawan ditemukan
                        <br><strong>Nama:</strong> ${data.fullName}
                        <br><strong>NIP:</strong> ${data.nip}
                        <br><strong>Foto:</strong> ${data.photoUrl ? 'Ada' : 'Tidak ada'}
                        ${data.photoUrl ? `<br><img src="${data.photoUrl}" class="photo-preview" alt="Wawan">` : ''}
                    </div>
                `;
            } else {
                checkDiv.innerHTML = '<div class="error">‚ùå Profil Wawan tidak ditemukan</div>';
            }
        }

        function checkActivities() {
            const db = localStorage.getItem('local-database');
            const checkDiv = document.getElementById('activitiesCheck');
            
            if (db) {
                const data = JSON.parse(db);
                const total = (data.tasks?.length || 0) + (data.supervisions?.length || 0) + 
                             (data.events?.length || 0) + (data.additionalTasks?.length || 0);
                
                checkDiv.innerHTML = `
                    <div class="success">
                        ‚úÖ Aktivitas Wawan ditemukan
                        <br><strong>Total:</strong> ${total} aktivitas
                        <br>‚Ä¢ Tugas: ${data.tasks?.length || 0}
                        <br>‚Ä¢ Supervisi: ${data.supervisions?.length || 0}
                        <br>‚Ä¢ Kegiatan: ${data.events?.length || 0}
                        <br>‚Ä¢ Tugas Tambahan: ${data.additionalTasks?.length || 0}
                    </div>
                `;
            } else {
                checkDiv.innerHTML = '<div class="error">‚ùå Aktivitas Wawan tidak ditemukan</div>';
            }
        }

        function checkUserManagement() {
            const users = localStorage.getItem('app_users');
            const checkDiv = document.getElementById('userMgmtCheck');
            
            if (users) {
                const data = JSON.parse(users);
                const wawan = data.find(u => u.username === 'wawan');
                
                checkDiv.innerHTML = `
                    <div class="success">
                        ‚úÖ User management data ditemukan
                        <br><strong>Total users:</strong> ${data.length}
                        <br><strong>Wawan:</strong> ${wawan ? 'Ada' : 'Tidak ada'}
                        ${wawan ? `<br><strong>ID:</strong> ${wawan.id}` : ''}
                    </div>
                `;
            } else {
                checkDiv.innerHTML = '<div class="error">‚ùå User management data tidak ditemukan</div>';
            }
        }

        function updateStatusGrid() {
            const grid = document.getElementById('statusGrid');
            const checks = [
                { key: 'user_profile', label: 'Profil Wawan' },
                { key: 'local-database', label: 'Aktivitas Wawan' },
                { key: 'app_users', label: 'User Management' }
            ];
            
            grid.innerHTML = checks.map(check => {
                const exists = localStorage.getItem(check.key);
                const status = exists ? 'status-ok' : 'status-error';
                const icon = exists ? '‚úÖ' : '‚ùå';
                return `<div class="status-item ${status}">${icon} ${check.label}</div>`;
            }).join('');
        }

        // Utility functions
        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        function showDebugInfo() {
            const debugOutput = document.getElementById('debugOutput');
            const debugData = {
                localStorage_keys: Object.keys(localStorage),
                user_profile: localStorage.getItem('user_profile'),
                local_database: localStorage.getItem('local-database'),
                app_users: localStorage.getItem('app_users')
            };
            
            debugOutput.innerHTML = `<pre>${JSON.stringify(debugData, null, 2)}</pre>`;
        }

        function exportData() {
            const data = {};
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                data[key] = localStorage.getItem(key);
            }
            
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'wawan_data_backup.json';
            a.click();
            URL.revokeObjectURL(url);
        }

        function clearData() {
            if (confirm('Hapus semua data localStorage?')) {
                localStorage.clear();
                alert('‚úÖ Data telah dihapus');
                updateStatusGrid();
            }
        }

        // Auto-run on page load
        window.onload = function() {
            console.log('üöÄ Setup tool loaded');
            updateStatusGrid();
            
            // Check if data already exists
            const hasProfile = localStorage.getItem('user_profile');
            const hasActivities = localStorage.getItem('local-database');
            const hasUsers = localStorage.getItem('app_users');
            
            if (!hasProfile || !hasActivities || !hasUsers) {
                setTimeout(() => {
                    if (confirm('Data Wawan belum lengkap. Jalankan setup otomatis sekarang?')) {
                        setupAllData();
                    }
                }, 1000);
            } else {
                console.log('‚úÖ Data Wawan sudah ada');
            }
        };
    </script>
</body>
</html>